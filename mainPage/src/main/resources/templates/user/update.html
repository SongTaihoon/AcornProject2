<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>회원 수정</title>
<link rel="stylesheet" href="/public/css/user/detail.css">
<!-- 주소API기능연동 -->
<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js" defer="defer"></script>
<script th:src="@{/public/js/adressApi.js}" defer="defer"></script>
</head>
<body>
<header th:insert="/NewHeader"></header>
	<div id="wrapper">
	 <main class="container-xl">
	   <nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb" id="path">
		  <ol class="breadcrumb">
		    <li class="breadcrumb-item">
		    	<a href="/">홈</a>
		    </li>
		    <li class="breadcrumb-item" aria-current="page">
		    	<a th:href="@{/users/detail/{userid}(userid=${user?.userid})}" 
		    	   class="breadcrumb-item active" th:text="${user?.username} + '(' + ${user?.userid} + ')'"></a>
		    </li>
		  </ol>
		</nav>
	    <h1 class="pb-4 d-flex justify-content-between align-items-center" 
		    style="border-bottom: 1px solid #e8e8e8; min-width: 1200px;">
		    <span style="font-size: 35px;">회원 수정</span>
	    </h1>	
		<form action="/user/update.do" method="post">
			<table class="mt-5 mb-5 table align-middle table-bordered">
				<tbody>
					<tr>
						<th class="table-light">이름</th>
						<td>
							<input name="user_name" id="username" class="form-control" type="text" th:value="${user?.user_name}" 
								   onkeyup="noSpaceForm(this)" onchange="noSpaceForm(this)" maxlength="20">
						</td>
					</tr>
					<tr>
						<th class="table-light">아이디</th>
						<td>
							<input name="user_id" type="text" class="form-control" th:value="${user?.user_id}" readonly maxlength="20">
						</td>
					</tr>
					<tr>
						<th class="table-light">비밀번호</th>
						<td>
							<input name="user_pw" id="userpw" class="form-control" type="text" th:value="${user?.user_pw}" 
								   onkeyup="noSpaceForm(this)" onchange="noSpaceForm(this)" maxlength="16">
						</td>
					</tr>
					<tr>
						<th class="table-light">이메일</th>
						<td>
							<input name="user_email" id="email" class="form-control" type="email" th:value="${user?.user_email}" 
								   onkeyup="noSpaceForm(this)" onchange="noSpaceForm(this)">
						</td>
					</tr>
					<tr>
						<th class="table-light">전화번호</th>
						<td>
							<input name="user_phone" id="phone" class="form-control" type="tel" th:value="${user?.user_phone}" 
							       onkeydown="noSpaceForm(this)" onchange="noSpaceForm(this)" 
							       oninput="phoneAutoComplete(this)" onKeyup="this.value=this.value.replace(/[^-0-9]/g,'');" maxlength="13">
						</td>
					</tr>
					<tr>
						<th class="table-light">생일</th>
						<td>
							<input name="birth" id="birth" class="form-control" type="date" th:value="${#dates.format(user?.birth, 'yyyy-MM-dd')}">
						</td>
					</tr>
					<tr>
						<th class="table-light">우편번호</th>
						<td style="text-align: left;">
						<div class="d-flex align-items-center">
							<input name="add1" id="sample6_postcode" type="text" th:value="${user?.add1}" 
							class="form-control" style="display:inline; width:85%; margin-right: 8px;" readonly>
							<input type="button" class="btn btn-secondary" onclick="sample6_execDaumPostcode()" value="우편번호 찾기" style="display:inline; width:15%;">
							</div>
						</td>
					</tr>
					<tr>
						<th class="table-light">주소</th>
						<td>
							<input name="add2" id="sample6_address" type="text" size="40" th:value="${user?.add2}" class="form-control" readonly>
						</td>	
					</tr>
					<tr>
						<th class="table-light">상세 주소</th>
						<td>
							<input name="add3" id="sample6_detailAddress" type="text" size="40" th:value="${user?.add3}" class="form-control"
								   onkeyup="noSpace(this)" onchange="noSpace(this)">
						</td>	
					</tr>
					<tr>
						<th class="table-light">참고 항목</th>
						<td>
							<input name="add4" id="sample6_extraAddress" type="text" size="40" th:value="${user?.add4}" class="form-control" readonly>
						</td>	
					</tr>
					<tr>
						<th class="table-light">가입일</th>
						<td>
							<input name="signup" id="inputSignup" class="form-control" type="text" 
				    			 th:value="${#dates.format(user?.signup, 'yyyy-MM-dd HH:mm:ss')}" readonly>
						</td>	
					</tr>
				</tbody>
			</table>
			<div class="d-flex mb-3 g-3">
				<div class="ms-auto">
					<button type="reset" class="btn btn-outline-warning btn-lg">초기화</button>
					<button type="submit" class="btn btn-outline-success btn-lg" style="margin-left: 8px; margin-right: 8px;">수정</button>
					<a class="btn btn-outline-danger btn-lg" th:href="@{/user/delete/{userId}(userId=${user?.user_id})}" 
					   style="margin-right: 8px;">삭제</a>
					<a class="btn btn-outline-dark btn-lg" th:href="@{/user/detail/{userId}(userId=${user?.user_id})}">취소</a>
				</div>
			</div>
		</form>
	  </main>
<footer class="footer" th:insert="/NewFooter"></footer>
</div>
</body>
<script>
function noSpaceForm(obj) { // 공백 사용 못하게
   var str_space = /\s/;  // 공백 체크
   if(str_space.exec(obj.value.trim)) { //공백 체크
       //alert("해당 항목에는 공백을 사용할수 없습니다.\n\n공백은 자동적으로 제거 됩니다.");
       obj.focus();
       obj.value = obj.value.replace(/\s| /gi,''); // 공백 제거
       return false;
   }
}
function noSpace(obj) { // 공백사용못하게
    var str = /\s/;  // 공백체크
    if(str.exec(obj.value.trim)) { //공백 체크
        //alert("해당 항목에는 첫 글자 공백을 사용할수 없습니다.");
        obj.focus();
        obj.value = obj.value.replace(/^ +/,''); // 공백제거
        return false;
    }
}
function phoneAutoComplete(e) {
    var number = e.value.replace(/[^0-9]/g, "");
    var phone = "";
 
    if (number.length < 4) {
         return number;
     } else if (number.length < 8) {
         phone += number.substr(0, 3);
         phone += "-";
         phone += number.substr(3);
     } else if (number.length < 9) {
         phone += number.substr(0, 3);
         phone += "-";
         phone += number.substr(3, 1);
         phone += "-";
         phone += number.substr(4, 4);
     } else if (number.length < 10) {
         phone += number.substr(0, 3);
         phone += "-";
         phone += number.substr(3, 2);
         phone += "-";
         phone += number.substr(5, 4);
     } else if (number.length < 11) {
         phone += number.substr(0, 3);
         phone += "-";
         phone += number.substr(3, 3);
         phone += "-";
         phone += number.substr(6, 4);
     } else {
		 phone += number.substr(0, 3);
         phone += "-";
         phone += number.substr(3, 4);
         phone += "-";
         phone += number.substr(7, 4);
	 }
        e.value = phone;
}
</script>
</html>