<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>후기 수정</title>
<link rel="stylesheet" href="/public/css/board/detail.css">
<script th:src="@{/public/js/board/detail.js}" defer></script>
</head>
<body>
<header th:insert="/NewHeader"></header>
<div id="wrapper">
	<main class="container-xl">
		<nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb" id="path">
		  <ol class="breadcrumb">
		    <li class="breadcrumb-item">
		    	<a href="/">홈</a>
		    </li>
		    <li class="breadcrumb-item">
		    	<a href="#">게시판</a>
		    </li>
		    <li class="breadcrumb-item" aria-current="page">
		    	<a href="/board/list/1" class="breadcrumb-item active">후기</a>
		    </li>
		  </ol>
		</nav>
		<h1 class="pb-4 d-flex justify-content-between align-items-center" 
		    style="border-bottom: 1px solid #e8e8e8; min-width: 1200px;">
		    <span style="font-size: 35px;">후기 수정</span>
	    </h1>	
		<div class="mt-3 d-flex">
			<div class="d-flex align-items-center">
				<i class="bi bi-eye" style="margin-right: 4px;"
					data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="조회수">
					<span th:text="${board.views}"></span>
				</i>
				<a style="margin-right: 4px; margin-left: 4px;"
			 	data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="좋아요!"
				class="btn btn-outline-primary border-0 rounded-pill">
					<i th:classappend="${(board.prefer_active != null && board.prefer_active) ? 'bi-hand-thumbs-up-fill' : 'bi-hand-thumbs-up'}" class="bi "></i>				
					<span th:text="${board.good}"></span>
				</a> 
				<a style="margin-right: 8px;"
			 	data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="싫어요!"
				class="btn btn-outline-danger border-0 rounded-pill">
					<i th:classappend="${(board.prefer_active != null && !board.prefer_active) ? 'bi-hand-thumbs-down-fill' : 'bi-hand-thumbs-down'}" class="bi "></i>				
					<span th:text="${board.bad}"></span>
				</a>
			</div>
	  </div>
	  <div class="mt-3">
	   <form action="/board/update.do" method="post" enctype="multipart/form-data" name="boardUpdateForm">
		 <table class="mb-5 table table-bordered table">
		  <tbody>
		  	<tr>
		      <th style="width: 100px;" class="bg-light align-middle">글 번호</th>
		      <td style="width: 900px;">
		      	<input name="board_no" class="form-control" id="board_no" th:value="${board.board_no}" readonly>
		      </td>
		    </tr>
		    <tr>
		      <th style="width: 100px;" class="bg-light align-middle">작성자</th>
		      <td style="width: 900px;">
		      	<input name="users.userid" class="form-control" id="userId" th:value="${board.users.userid}" readonly>
		      </td>
		    </tr>
		    <tr>
		      <th style="width: 100px;" class="bg-light align-middle">카테고리</th>
		      <td style="width: 600px;">
		      	<select name="category" class="form-select" id="category">
					<option value="관광지">관광지</option>
					<option value="음식">음식</option>
					<option value="숙박">숙박</option>
				</select>
		      </td>
		    </tr>
		    <tr>
		      <th style="width: 100px;" class="bg-light align-middle">장소명</th>
		      <td style="width: 600px;">
		      	<input name="userId" class="form-control" id="userId" th:value="${session.loginUsers.userid}" onkeyup="noSpace(this)" onchange="noSpace(this)">
		      </td>
		    </tr>
		    <tr>
		      <th style="width: 100px;" class="bg-light align-middle">별점</th>
		      <td style="width: 600px;">
		      	<select name="rating" class="form-select" id="rating">
					<option value="0.0">0.0</option>
					<option value="0.5">0.5</option>
					<option value="1.0">1.0</option>
					<option value="1.5">1.5</option>
					<option value="2.0">2.0</option>
					<option value="2.5">2.5</option>
					<option value="3.0">3.0</option>
					<option value="3.5">3.5</option>
					<option value="4.0">4.0</option>
					<option value="4.5">4.5</option>
					<option value="5.0">5.0</option>
				</select>
		      </td>
		    </tr>
		    <tr>
		    	<th style="width: 100px;" class="bg-light align-middle">사진</th>
		    	<td>
					<div>
						<p>삭제할 사진 선택</p>
						<th:block th:each="boardImg : ${board.boardImgs}">
							<label>
								<input name="boardImgNo" type="checkbox"
									   class="form-check-input" th:value="${boardImg.board_img_no}">
								<img alt="게시글 이미지" 
									 th:src="@{/img/{file}(file=${boardImg.img_path})}" 
									 class="img-thumbnail" width="200">
							</label>
						</th:block>
					</div>
				    <div class="mb-3">
						<input name="imgFile" class="form-control mb-1 form-control-lg" type="file">
						<input name="imgFile" class="form-control mb-1 form-control-lg" type="file">
						<input name="imgFile" class="form-control mb-1 form-control-lg" type="file">
					</div>
		    	</td>
		    </tr>
		    <tr>
		      <th style="width: 100px;" class="bg-light align-middle">제목</th>
		      <td style="width: 600px;">
		      	<input name="title" class="form-control" id="title" th:value="${board.title}" onkeyup="noSpace(this)" onchange="noSpace(this)">
		      </td>
		    </tr>
		    <tr>
		      <th style="width: 100px;" class="bg-light align-middle">내용</th>
		      <td style="width: 600px;">
		      	<textarea name="contents" class="form-control" th:text="${board.contents}"
		      			  onkeyup="noSpace(this)" onchange="noSpace(this)"></textarea>
		      </td>
		    </tr>
		  </tbody>
		</table>
		<div class="d-flex">
			<div class="ms-auto">
				<button class="btn btn-outline-warning btn-lg" type="reset">초기화</button>
				<button class="btn btn-outline-success btn-lg" type="submit" style="margin-left: 8px; margin-right: 8px;">수정</button>
				<th:block th:if="${session.loginUsers?.adminCk == 1}">
					<a th:href="@{/board/delete/{boardNo}/{userId}(boardNo=${board.board_no}, userId=${session.loginUsers.userid})}" 
					   class="btn btn-outline-danger btn-lg" style="margin-right: 8px;">
						삭제
					</a>
				</th:block>
				<th:block th:unless="${session.loginUsers?.adminCk == 1}">
					<a th:href="@{/board/delete/{boardNo}/{userId}(boardNo=${board.board_no}, userId=${board.users.userid})}" 
					   class="btn btn-outline-danger btn-lg" style="margin-right: 8px;">
						삭제
					</a>
				</th:block>
				<a th:href="@{/board/detail/{boardNo}(boardNo=${board.board_no})}" class="btn btn-outline-dark btn-lg ms-auto">취소</a>
			</div>
		</div>
	   </form>
	  </div>
	</main>	
<footer class="footer" th:insert="/NewFooter"></footer>
</div>	
</body>
<script type="text/javascript">
function noSpace(obj) { // 공백사용못하게
    var str = /\s/;  // 공백체크
    if(str.exec(obj.value.trim)) { //공백 체크
        //alert("해당 항목에는 첫 글자 공백을 사용할수 없습니다.");
        obj.focus();
        obj.value = obj.value.replace(/^ +/,''); // 공백제거
        return false;
    }
}
//값이 없을 때 submit 불가
var boardUpdateForm = document.forms.boardUpdateForm;
var title = boardUpdateForm.title;
var contents = boardUpdateForm.contents;
boardUpdateForm.addEventListener("submit", (event) => {
	if(!title.value || !contents.value) {
		event.preventDefault();		
	}
});
</script>
</html>